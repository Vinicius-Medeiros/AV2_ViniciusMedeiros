from flask import Flask,request,render_template

app = Flask(__name__, template_folder="templates")
database={'nachi':'123','james':'aac','karthik':'asdsf'}

login = lambda : render_template("login.html")

userInDB = lambda : render_template('login.html',info='Invalid User') if request.form['username'] not in database else True
canLogin = lambda : render_template('login.html',info='Invalid Password') if database[request.form['username']] != request.form['password'] else render_template('home.html',name=request.form['username'])
loginAction = lambda : canLogin() if userInDB() else None

goToRegister = lambda : render_template('register.html')

addUserInDB = lambda : render_template('login.html',info='User registered with success') if database.update({request.form['username']: request.form['password']}) else None
registerUser = lambda : addUserInDB() if request.form['username'] not in database else render_template('register.html',info='User already exists')
    
app.add_url_rule('/login', '/login', login)
app.add_url_rule('/form_login', '/login', loginAction, methods=['GET', 'POST'])
app.add_url_rule('/register', '/register', goToRegister)
app.add_url_rule('/form_register', '/register', registerUser, methods=['GET', 'POST'])
app.run(host='0.0.0.0', port=8080)